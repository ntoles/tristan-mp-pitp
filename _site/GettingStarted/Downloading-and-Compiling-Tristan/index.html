<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Compiling Tristan-MP - Tristan-MP Documentation</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Compiling Tristan-MP | Tristan-MP Documentation</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Compiling Tristan-MP" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A wiki of Machine learning and Statistics resources useful for self-learning." /> <meta property="og:description" content="A wiki of Machine learning and Statistics resources useful for self-learning." /> <link rel="canonical" href="http://localhost:4000/GettingStarted/Downloading-and-Compiling-Tristan/" /> <meta property="og:url" content="http://localhost:4000/GettingStarted/Downloading-and-Compiling-Tristan/" /> <meta property="og:site_name" content="Tristan-MP Documentation" /> <script type="application/ld+json"> {"headline":"Compiling Tristan-MP","description":"A wiki of Machine learning and Statistics resources useful for self-learning.","@type":"WebPage","url":"http://localhost:4000/GettingStarted/Downloading-and-Compiling-Tristan/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Tristan-MP Documentation </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/README/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/GettingStarted/outline/" class="nav-list-link">Getting Started</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/GettingStarted/Logging-in-to-perseus/" class="nav-list-link">Logging into Perseus</a></li><li class="nav-list-item active"><a href="http://localhost:4000/GettingStarted/Downloading-and-Compiling-Tristan/" class="nav-list-link active">Compiling Tristan-MP</a></li><li class="nav-list-item "><a href="http://localhost:4000/GettingStarted/Running-your-first-Tristan-MP-simulation/" class="nav-list-link">Running Tristan-MP</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/AnalyzingSims/outline/" class="nav-list-link">Analyzing Simulations</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/AnalyzingSims/Logging-in-to-tigressdata2/" class="nav-list-link">Logging into TigressData2</a></li><li class="nav-list-item "><a href="http://localhost:4000/AnalyzingSims/Writing-your-own-python-scripts/" class="nav-list-link">Writing a python analysis script</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Example%20Simulations/outline/" class="nav-list-link">Example Simulations</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/Example%20Simulations/Sample-Weibel-run/" class="nav-list-link">Weibel Simulation</a></li><li class="nav-list-item "><a href="http://localhost:4000/Example%20Simulations/Sample-shock-run/" class="nav-list-link">Shock Simulation</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/outline/" class="nav-list-link">Tristan-MP Features and Code Structure</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/Code-Features/" class="nav-list-link">Code Features</a></li><li class="nav-list-item "><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/Input-Files/" class="nav-list-link">Input Files</a></li><li class="nav-list-item "><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/User-Files/" class="nav-list-link">User Files</a></li><li class="nav-list-item "><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/Compilation/" class="nav-list-link">Compiling Tristan</a></li><li class="nav-list-item "><a href="http://localhost:4000/Tristan-MP%20Features%20And%20Code%20Structure/Running/" class="nav-list-link">Running Tristan</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/User%20Manual/User-Manual/" class="nav-list-link">User Manual</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/RunningOnOtherClusters/outline/" class="nav-list-link">Running On Other HPC Clusters</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/RunningOnOtherClusters/nersc/" class="nav-list-link">Nersc Cori</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Tristan-MP Documentation" aria-label="Search Tristan-MP Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/GettingStarted/outline/">Getting Started</a></li> <li class="breadcrumb-nav-list-item"><span>Compiling Tristan-MP</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><em>This section assumes you have already <a href="/GettingStarted/Logging-in-to-perseus/">logged into perseus</a> and followed all the instructions to ensure you have loaded all the modules required to compile tristan-MP</em></p> <h2 id="downloading-tristan-mp-from-github"> <a href="#downloading-tristan-mp-from-github" aria-labelledby="downloading-tristan-mp-from-github" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading Tristan-MP from Github </h2> <p>Inside of perseus, cd to your tigress directory</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/tig
</code></pre></div></div> <p>Download tristan-mp from github.com to perseus by cloning the directory.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/PrincetonUniversity/tristan-mp-pu.git
</code></pre></div></div> <p>Go into the <code class="language-plaintext highlighter-rouge">tristan-mp-pu</code> folder</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>tristan-mp-pu
</code></pre></div></div> <h2 id="creating-your-own-tristan-mp-branch-and-user-files"> <a href="#creating-your-own-tristan-mp-branch-and-user-files" aria-labelledby="creating-your-own-tristan-mp-branch-and-user-files" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating your own Tristan-MP branch and user files </h2> <p>Create your own branch of Tristan-MP where you can edit your user-files</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout <span class="nt">-b</span> YOUR_NAME
</code></pre></div></div> <p>The structure of Tristan is such that you should not have to edit the main code to change the set-up of the files (more details <a href="/Tristan-MP Features And Code Structure/Code-Features.md">here</a>). Instead, the simulation set-up is changed using user_files that define important functions in the code. You should use your own user files. Make a new directory where you will save your user files</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>user_NAME
</code></pre></div></div> <p>Copy the code you want to work with. We’ll set-up Tristan-mp to run a shock problem. Each problem has its own user file and input file.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp </span>user_pu/user_shock_pu.F90 user_NAME/user_myshock.F90
<span class="nb">cp </span>user_pu/input.shock_pu user_NAME/input.myshock
</code></pre></div></div> <p>There is a line in user_myshock.f90 that writes the userfile name in the output while tristan-mp is running. This is a very convenient feature that lets you know what you compiled your run with, but must be updated for every new user file. Find the line. The easiest way to do this with nano is <code class="language-plaintext highlighter-rouge">nano user_NAME/user_myshock.F90</code>. Inside of nano, you can search for a string with <code class="language-plaintext highlighter-rouge">ctrl+W</code> then type ‘user_shock_pu’. Change the line from</p> <div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="ow">.eq.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">"Using user file user_shock_pu.F90"</span><span class="w">              
</span></code></pre></div></div> <p>to</p> <div class="language-fortran highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="ow">.eq.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">"Using user file user_NAME/user_myshock.F90"</span><span class="w">              
</span></code></pre></div></div> <p>Save and close the file in nano by pressing <code class="language-plaintext highlighter-rouge">ctrl+x</code> and then <code class="language-plaintext highlighter-rouge">y</code> and <code class="language-plaintext highlighter-rouge">enter</code> to the prompts.</p> <h2 id="compiling"> <a href="#compiling" aria-labelledby="compiling" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compiling </h2> <p>Compilation in Tristan-MP is handled with <a href="https://www.gnu.org/software/make/">make</a> and a Makefile. <em>Make</em> is a very full-featured program with many options. Luckily, you shouldn’t have to mess too much with the Makefile at first.</p> <p><code class="language-plaintext highlighter-rouge">cd</code> into the <code class="language-plaintext highlighter-rouge">~/tig/tristan-mp-pu</code> folder. We will want to compile tristan-mp, but before doing so it is good practice to first clean the directory in case you changed some files: type</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean
</code></pre></div></div> <p>While not always necessary, I think it is good habit to always run <code class="language-plaintext highlighter-rouge">make clean</code> before running <code class="language-plaintext highlighter-rouge">make</code>. Now compile tristan-mp pointing it towards your user file.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nv">USER_FILE</span><span class="o">=</span>user_NAME/user_myshock
</code></pre></div></div> <p>The executable “tristan-mp2d” should appear in the newly created <code class="language-plaintext highlighter-rouge">~tig/tristan-mp/exec</code> directory, check that it is there.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls exec</span>
</code></pre></div></div> <p>If instead you get a warning stating something along the lines of</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>h5pcc <span class="nt">-O3</span>  <span class="nt">-c</span> code/system.c <span class="nt">-o</span> obj/system.o
make: h5pcc: Command not found
make: <span class="k">***</span> <span class="o">[</span>obj/system.o] Error 127
</code></pre></div></div> <p>That means you have not loaded the proper modules to compile the code. Please ensure you are logged into perseus by typing <code class="language-plaintext highlighter-rouge">bash hostname</code>. If you are logged into perseus, check that you have loaded all the neccessary modules by typing <code class="language-plaintext highlighter-rouge">bash module list</code> you should find the following modules <code class="language-plaintext highlighter-rouge">intel, intel-mpi, hdf5/intel-16.0/intel-mpi/1.8.16</code> See more <a href="/GettingStarted/Logging-in-to-perseus/">here</a>. Remember to run <code class="language-plaintext highlighter-rouge">make clean</code> before trying to recompile.</p> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0">Website compiled by <a href="https://www.linkedin.com/in/patrick-crumley/">Patrick Crumley</a>. Please feel free to contribute on <a href="https://github.com/pcrumley/ml_stat_resources">GitHub.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
